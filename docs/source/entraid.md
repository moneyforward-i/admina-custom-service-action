# Entra ID (旧 Azure AD) からのシークレットキーの取得方法

このドキュメントでは、Admina Custom Service Actionで使用するEntra ID（旧称Azure AD）からのシークレットキーを取得する方法について説明します。

## 前提条件

- Entra ID（Azure AD）の管理者権限を持っていること
- Microsoft Azureポータルにアクセスできること

## 手順

### 1. アプリケーション登録

1. [Azure Portal](https://portal.azure.com/)にサインインします
2. 「Entra ID」（旧「Azure Active Directory」）を選択します
3. 左側のメニューから「アプリの登録」を選択します
4. 「新規登録」をクリックします
5. 以下の情報を入力します：
   - 名前：任意の名前（例：「Admina Sync App」）
   - サポートされているアカウントの種類：「この組織のディレクトリ内のアカウントのみ」
   - リダイレクトURI：空白のままでOK
6. 「登録」をクリックします

### 2. APIアクセス許可の設定

1. 作成したアプリケーションの画面で「APIのアクセス許可」を選択します
2. 「アクセス許可の追加」をクリックします
3. 「Microsoft Graph」を選択します
4. 「アプリケーションの許可」を選択します
5. 以下の許可を追加します：
   - `Application.Read.All`
   - `Directory.Read.All`
   - `Group.Read.All`
   - `ServicePrincipalEndpoint.Read.All`
   - `User.Read`
   - `User.Read.All`
6. 「アクセス許可の追加」をクリックします
7. 「（テナント名）に管理者の同意を与えます」をクリックして権限を有効化します

### 3. クライアントシークレットの作成

1. 左側のメニューから「証明書とシークレット」を選択します
2. 「新しいクライアントシークレット」をクリックします
3. 説明と有効期限を設定します（例：「Admina Sync Secret」、有効期限：24ヶ月）
4. 「追加」をクリックします
5. 生成されたシークレット値を**必ずコピーして安全に保管してください**（この画面を離れると二度と表示されません）

### 4. 必要な情報の取得

GitHub Actionsで使用するために以下の情報を取得します：

1. **クライアントID (ms_client_id)**: アプリケーションの「概要」ページに表示される「アプリケーション（クライアント）ID」
2. **テナントID (ms_tenant_id)**: 「概要」ページに表示される「ディレクトリ（テナント）ID」
3. **クライアントシークレット (ms_client_secret)**: 前のステップで生成・コピーしたシークレット値

## GitHub Actionsでの使用方法

取得した情報は、GitHub Actionsのシークレットとして設定し、ワークフローファイルで以下のように参照します：
